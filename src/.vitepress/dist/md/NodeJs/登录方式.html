<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>服务的登录方式 | Blink Docs</title>
    <meta name="description" content="web 前端 学习文档">
    <link rel="stylesheet" href="/doc/assets/style.49eed234.css">
    <link rel="modulepreload" href="/doc/assets/Home.0679cf58.js">
    <link rel="modulepreload" href="/doc/assets/app.ca5faf2f.js">
    <link rel="modulepreload" href="/doc/assets/md_NodeJs_登录方式.md.a7db5c52.lean.js">
    
    <meta name="twitter:title" content="服务的登录方式 | Blink Docs">
  <meta property="og:title" content="服务的登录方式 | Blink Docs">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/doc/" aria-label="Blink Docs, back to home" data-v-675d8756 data-v-cc01ef16><img class="logo" src="/doc/images/logo.png" alt="Logo" data-v-cc01ef16> Blink Docs</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><!----></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><!----><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><p class="sidebar-link-item">cli</p><ul class="sidebar-links"><li class="sidebar-link"><p class="sidebar-link-item">功能架构</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/cli/功能架构/初始化项目架构">初始化项目架构</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/cli/功能架构/基础架构">基础架构</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/cli/功能架构/模块拆分架构">模块拆分架构</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/cli/开发流程">开发流程</a><!----></li><li class="sidebar-link"><p class="sidebar-link-item">相关技术</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/cli/相关技术/cli-spinner">cli-spinner</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/cli/相关技术/commander">commander</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/cli/相关技术/ejs">ejs</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/cli/相关技术/import-local">import-local</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/cli/相关技术/inrequirer">inrequirer</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/cli/相关技术/kebab-case">kebab-case</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/cli/相关技术/npminstall">npminstall</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/cli/相关技术/readline">readline</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/cli/相关技术/yargs">yargs</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/cli/脚手架介绍">脚手架介绍</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">CSS</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/CSS/基本概念">基本概念</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/CSS/常见问题和实现">常见问题和实现</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">ECMAScript</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/ECMAScript/ES规范">ES规范</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/ECMAScript/new具体过程">new具体过程</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/ECMAScript/typescript">typescript</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/ECMAScript/关键概念">关键概念</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/ECMAScript/函数">函数</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/ECMAScript/类型">类型</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/ECMAScript/继承">继承</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/ECMAScript/防篡改对象">防篡改对象</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/ECMAScript/面向对象">面向对象</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Git</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/Git/git-flow">git-flow</a><!----></li><li class="sidebar-link"><p class="sidebar-link-item">gitlab</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/Git/gitlab/gitlab-runner">gitlab-runner</a><!----></li></ul></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">NodeJs</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/NodeJs/Date和时区">Date和时区</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/NodeJs/npm与package-json">npm与package-json</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/NodeJs/pm2">pm2</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/NodeJs/require">require</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/NodeJs/全局变量">全局变量</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/NodeJs/本地调试npm包">本地调试npm包</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item active" href="/doc/md/NodeJs/登录方式">登录方式</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#cookie">Cookie</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#基于-cookie-的-session">基于 Cookie 的 Session</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#jwt-json-web-token">JWT(Json web token)</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#sso-single-sign-on">SSO : Single Sign On</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#同域下的单点登录">同域下的单点登录</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#不同域下的单点登录">不同域下的单点登录</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#oauth2">OAuth2</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#运行流程">运行流程</a><!----></li></ul></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/NodeJs/进程">进程</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">VSCode</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/VSCode/代码片段">代码片段</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Vue</p><ul class="sidebar-links"><li class="sidebar-link"><p class="sidebar-link-item">Vue2</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/Vue/Vue2/相关概念和原理">相关概念和原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/Vue/Vue2/组件中使用Echarts">组件中使用Echarts</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Vue3</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/Vue/Vue3/compositionAPI">compositionAPI</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/Vue/Vue3/与Vue2比较的优化">与Vue2比较的优化</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/Vue/Vue3/与Vue2比较的新特性">与Vue2比较的新特性</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/Vue/Vue3/副作用">副作用</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/Vue/Vue3/响应式对象">响应式对象</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/Vue/Vuex">Vuex</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/Vue/组件之间通信的4种方法">组件之间通信的4种方法</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/Vue/组件库的创建">组件库的创建</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">业务实现</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/业务实现/录音">录音</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/业务实现/打印页面中的元素">打印页面中的元素</a><!----></li><li class="sidebar-link"><p class="sidebar-link-item">登录</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/业务实现/登录/vue2-element">vue2-element</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/业务实现/登录/主要逻辑">主要逻辑</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/业务实现/表格下载">表格下载</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">其他</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/其他/cron表达式">cron表达式</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/其他/glob">glob</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/其他/地图概念">地图概念</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/其他/正则表达式">正则表达式</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">常考算法</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/常考算法/apply">apply</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/常考算法/Proxy响应式">Proxy响应式</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/常考算法/Vue2响应式">Vue2响应式</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/常考算法/发布订阅">发布订阅</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/常考算法/数组相关">数组相关</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/常考算法/树的遍历">树的遍历</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/常考算法/深复制">深复制</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/常考算法/防抖和节流">防抖和节流</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">性能</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/性能/分析工具">分析工具</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/性能/前端性能优化">前端性能优化</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">数据库</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/数据库/mysql">mysql</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/数据库/sequelize">sequelize</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">服务器</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/服务器/docker">docker</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/服务器/nginx">nginx</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">构建</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/nodemon">nodemon</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/rollup">rollup</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/vite">vite</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/webpack">webpack</a><!----></li><li class="sidebar-link"><p class="sidebar-link-item">代码规范</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/代码规范/editor-config">editor-config</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/代码规范/ESLint">ESLint</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/代码规范/项目结构规范">项目结构规范</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">包管理-lerna</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/包管理-lerna/Lerna源码">Lerna源码</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/包管理-lerna/Lerna简介">Lerna简介</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">包管理-pnpm</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/包管理-pnpm/简介">简介</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">持续集成部署CI</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/持续集成部署CI/gitlab-runner">gitlab-runner</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/持续集成部署CI/travis">travis</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">提交规范</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/提交规范/commitizen">commitizen</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/提交规范/commitlint">commitlint</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/提交规范/husky">husky</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/提交规范/lint-staged">lint-staged</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/提交规范/pretty-quick">pretty-quick</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">文档构建</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/文档构建/vitepress">vitepress</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/模块化">模块化</a><!----></li><li class="sidebar-link"><p class="sidebar-link-item">私有模块仓库</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/构建/私有模块仓库/verdaccio">verdaccio</a><!----></li></ul></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">浏览器设备</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/浏览器设备/GC（垃圾回收机制）">GC（垃圾回收机制）</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/浏览器设备/事件循环">事件循环</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/浏览器设备/储存">储存</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/浏览器设备/关键渲染路径">关键渲染路径</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/浏览器设备/兼容">兼容</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/浏览器设备/小程序">小程序</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/浏览器设备/盒模型">盒模型</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/浏览器设备/相关概念">相关概念</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/浏览器设备/跨域">跨域</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">网络</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/网络/GraphQL和RestfulAPI">GraphQL和RestfulAPI</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/网络/HTTPS">HTTPS</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/网络/HTTP基础">HTTP基础</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/网络/HTTP版本">HTTP版本</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/网络/SEO">SEO</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/网络/web的攻击技术">web的攻击技术</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/doc/md/网络/网络基础">网络基础</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="服务的登录方式" tabindex="-1">服务的登录方式 <a class="header-anchor" href="#服务的登录方式" aria-hidden="true">#</a></h1><h2 id="cookie" tabindex="-1"><code>Cookie</code> <a class="header-anchor" href="#cookie" aria-hidden="true">#</a></h2><p><strong>原理：</strong></p><ol><li>客户端通过请求将账户密码发送到服务端</li><li>服务端验证账户密码 <ul><li>验证成功返回加密的<code>set-cookie</code>响应请求头，将用户信息设置到客户端<code>cookie</code>中</li><li>验证失败返回错误信息</li></ul></li><li>之后客户端发送的请求都会自动携带此<code>cookie</code>，服务端通过<code>cookie</code>获得用户的信息 <ul><li>在用户信息中可设置过期时间</li><li>过期或者解密失败</li></ul></li></ol><p>特点：</p><ul><li>储存在浏览器的一段字符串，不大于5kb</li><li>跨域不共享</li><li>服务端可以修改<code>cookie</code>返回</li><li>浏览器可以修改<code>cookie</code>（有限制）</li><li>发送<code>http</code>请求自动携带对应请求域<code>cookie</code>发送给服务端</li></ul><p>node操作：</p><ul><li><code>req.headers.cookie</code></li></ul><p>浏览器操作：</p><ul><li><code>document.cookie</code></li></ul><p>参数：</p><ul><li>不允许客户端修改：<code>httpOnly</code></li><li>过期时间，<code>GMT</code>格式：<code>expires</code></li></ul><p>存在的问题：</p><ul><li>暴露用户信息等敏感数据</li></ul><h2 id="基于-cookie-的-session" tabindex="-1">基于 <code>Cookie</code> 的 <code>Session</code> <a class="header-anchor" href="#基于-cookie-的-session" aria-hidden="true">#</a></h2><p>解决<code>cookie</code>存在的暴露问题。</p><p><strong>原理：</strong></p><ol><li>对用户信息等敏感数据生成对应的<code>token</code>，将用户信息保存在服务端<code>session</code>，将<code>token</code>设置到客户端<code>cookie</code></li><li>客户端请求时会携带保存有<code>token</code>的<code>cookie</code>到服务端，服务端根据<code>token</code>查找缓存在<code>session</code>中的用户信息</li></ol><p>特点：</p><ul><li>用户信息保存在服务端，避免将敏感数据发送到客户端</li><li>方便服务端对用户进行管理</li><li>占用服务端内存</li></ul><p>存在的问题：</p><ul><li><code>session</code>是<code>js</code>变量，放在进程内存中，变量过大内存不足怎么办</li><li>跨域不会携带<code>cookie</code>，需要设置跨域资源共享<code>cors</code>，并在客户端请求配置中设置跨域携带<code>cookie</code>的设置</li><li>操作系统会限制一个进程的最大可用内存</li><li>如果是多进程的，进程之间的内存不能共享</li></ul><p>如何解决<code>session</code>共享的问题：</p><ol><li>数据持久化 <ul><li>使用共享内存：<code>redis</code></li><li>写入数据库</li></ul></li><li>不保存<code>session</code>数据，将数据保存在客户端 <ul><li><code>jwt</code></li></ul></li></ol><h2 id="jwt-json-web-token" tabindex="-1"><code>JWT</code>(<code>Json web token</code>) <a class="header-anchor" href="#jwt-json-web-token" aria-hidden="true">#</a></h2><p>相关文章：</p><ul><li><a href="https://www.jianshu.com/p/576dbf44b2ae" target="_blank" rel="noopener noreferrer">什么是<code>JWT</code></a></li><li><a href="http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html" target="_blank" rel="noopener noreferrer"><code>JWT</code>入门</a></li></ul><p>原理：</p><ol><li>服务端认证后，生成用户数据对象，并使用对应规则签名这个对象获得一个加密字符串<code>JWT</code>，返回给客户端</li><li>客户端自己将<code>token</code>保存在<code>cookie</code>或者<code>storage</code>中</li><li>客户端在请求时手动将<code>JWT</code>附在请求头中，通常为<code>Authorization: Bearer &lt;token&gt;</code></li><li>服务端获取到客户端发送的<code>token</code>，解密验证<code>token</code>的有效性，使用附带的数据</li></ol><p><strong><code>JWT</code>的结构</strong></p><div class="language-"><pre><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ
</code></pre></div><p>它被<code>.</code>分割为三个部分：<code>header.payload.signature</code></p><p><strong><code>header</code></strong> 包含两部分信息：</p><ul><li>声明类型：<code>JWT</code></li><li>声明加密算法：通常用<code>HMAC SHA256</code></li></ul><div class="language-json"><pre><code><span class="token punctuation">{</span>
  <span class="token property">&quot;typ&quot;</span><span class="token operator">:</span><span class="token string">&quot;JWT&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;alg&quot;</span><span class="token operator">:</span><span class="token string">&quot;HS256&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对这部分内容进行<code>base64</code>加密，得到<code>header</code>字符串：</p><div class="language-"><pre><code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9
</code></pre></div><p><strong><code>payload</code></strong> 存放有效信息的地方，包含三个部分内容</p><ul><li>标准声明</li><li>公共声明</li><li>私有声明</li></ul><p>标准声明（建议但不强制使用）：</p><ul><li><code>iss</code>: <code>jwt</code>签发者</li><li><code>sub</code>: <code>jwt</code>所面向的用户</li><li><code>aud</code>: 接收<code>jwt</code>的一方</li><li><code>exp</code>: <code>jwt</code>的过期时间，这个过期时间必须要大于签发时间</li><li><code>nbf</code>: 定义在什么时间之前，该<code>jwt</code>都是不可用的.</li><li><code>iat</code>: <code>jwt</code>的签发时间</li><li><code>jti</code>: <code>jwt</code>的唯一身份标识，主要用来作为一次性<code>token</code>,从而回避重放攻击。</li></ul><p>公共声明（任意）： 添加业务相关的必要信息</p><p>私有声明（任意）： 添加与业务无关的信息</p><div class="language-json"><pre><code><span class="token punctuation">{</span>
  <span class="token property">&quot;sub&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1234567890&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 标准</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;John Doe&quot;</span><span class="token punctuation">,</span>   <span class="token comment">// 公共</span>
  <span class="token property">&quot;admin&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>         <span class="token comment">// 私有</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对这部分内容进行<code>base64</code>加密，得到<code>payload</code>字符串：</p><div class="language-"><pre><code>eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9
</code></pre></div><p><strong><code>signature</code></strong> 对前两部分的签名，防止数据篡改</p><ol><li>首先指定一个私有密钥：<code>secret</code>，保存在服务端</li><li>使用<code>.</code>组合<code>base64</code>处理后的<code>header</code>和<code>payload</code>，得到一个待加密的字符串</li><li>使用<code>header</code>中声明的加密方式通过<code>secret</code>对待加密的字符串加盐加密得到第三部分：<code>signature</code></li><li>最终可以组合成<code>jwt</code></li></ol><div class="language-javascript"><pre><code><span class="token keyword">const</span> secret <span class="token operator">=</span> <span class="token string">&#39;abc123&#39;</span>
<span class="token keyword">const</span> encodedString <span class="token operator">=</span> <span class="token function">base64</span><span class="token punctuation">(</span>header<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;.&#39;</span> <span class="token function">base64</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
<span class="token keyword">const</span> signature <span class="token operator">=</span> <span class="token constant">HMACSHA256</span><span class="token punctuation">(</span>encodedString<span class="token punctuation">,</span> secret<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> jwt <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">base64</span><span class="token punctuation">(</span>header<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">base64</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>signature<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
</code></pre></div><p>优点：</p><ul><li>根据<code>json</code>的通用性，可以支持多语言服务端</li><li>构成简单，方便传输</li><li>不在服务端保存会话信息，便于扩展</li></ul><p>缺点：</p><ul><li><code>payload</code>是<code>base64</code>对称加密，<code>jwt</code>不加密不应该保存敏感信息到<code>payload</code></li><li>无法实时管理用户数据</li></ul><h2 id="sso-single-sign-on" tabindex="-1"><code>SSO</code> : <code>Single Sign On</code> <a class="header-anchor" href="#sso-single-sign-on" aria-hidden="true">#</a></h2><p>在多个应用系统中，只需要登录一次，就可以访问其他相互信任的应用系统。</p><h3 id="同域下的单点登录" tabindex="-1">同域下的单点登录 <a class="header-anchor" href="#同域下的单点登录" aria-hidden="true">#</a></h3><p>一个企业一般情况下只有一个域名，通过二级域名区分不同的系统。 比如我们有个域名叫做：<code>a.com</code>，同时有两个业务系统分别为：<code>app1.a.com</code> 和 <code>app2.a.com</code>。 我们要做单点登录，需要一个登录系统，叫做：<code>sso.a.com</code>。 我们需要在<code>sso.a.com</code>登录后在 <code>app1.a.com</code> 和 <code>app2.a.com</code> 也就登录了。</p><ul><li>如何在他们之间共享登录状态？ <ul><li><code>cookie</code><code>domain</code>选项表示的是<code>cookie</code>所在的域，默认为请求的地址，将<code>domain</code>设置为<code>.a.com</code>就可以使二级域名都可以访问到这个<code>cookie</code></li></ul></li></ul><h3 id="不同域下的单点登录" tabindex="-1">不同域下的单点登录 <a class="header-anchor" href="#不同域下的单点登录" aria-hidden="true">#</a></h3><p>首次登录流程：</p><ol><li>用户访问<code>app1</code>系统，<code>app1</code>系统是需要登录的，但用户现在没有登录。</li><li>跳转到<code>SSO</code>登录系统，<code>SSO</code>系统也没有登录，弹出用户登录页。</li><li>用户填写用户名、密码，<code>SSO</code>系统进行认证后，将登录状态写入<code>SSO</code>的<code>session</code>，浏览器（<code>Browser</code>）中写入<code>SSO</code>域下的<code>Cookie</code>。</li><li><code>SSO</code>系统登录完成后会生成一个<code>ST</code>（<code>Service Ticket</code>），<code>SSO</code>登录系统携带<code>ST</code>跳转到<code>app1</code>系统。</li><li><code>app1</code>系统拿到ST后，从后台向<code>SSO</code>发送请求，验证<code>ST</code>是否有效。</li><li>验证通过后，<code>app1</code>系统将登录状态写入<code>session</code>并设置<code>app1</code>域下的<code>Cookie</code>。</li></ol><p>其他系统登录流程：</p><ol><li>之后未登录的<code>app2</code>、<code>app3</code>会跳转<code>SSO</code>系统</li><li>此时<code>SSO</code>已经登录完成，不需要重新登录验证</li><li>重复首次登录的 4-5 步骤</li></ol><h2 id="oauth2" tabindex="-1"><code>OAuth2</code> <a class="header-anchor" href="#oauth2" aria-hidden="true">#</a></h2><p>第三方鉴权的常用方式</p><p>应用场景：应用提供给第三方应用部分使用权限，如：qq授权网易云音乐，使网易云音乐获得qq的用户名和头像</p><p><code>OAuth2</code> 中几个名词：</p><ul><li><code>Third-party application</code>：第三方应用程序，本文中又称&quot;客户端&quot;，指例子中的 <strong>网易云音乐</strong></li><li><code>HTTP service</code>：HTTP服务提供商，指 <strong><code>qq</code></strong></li><li><code>Resource Owner</code>：资源所有者，指<strong>用户</strong></li><li><code>User Agent</code>：用户代理，指<strong>浏览器</strong></li><li><code>Authorization server</code>：<strong>认证服务器</strong>，即服务提供商（<strong><code>qq</code></strong>）专门用来处理认证的服务器。</li><li><code>Resource server</code>：资源服务器，即服务提供商（<strong><code>qq</code></strong>）存放用户生成的资源的服务器。</li></ul><h3 id="运行流程" tabindex="-1">运行流程 <a class="header-anchor" href="#运行流程" aria-hidden="true">#</a></h3><ol><li>用户打开客户端以后，客户端要求用户给予授权。</li><li>用户同意给予客户端授权。</li><li>客户端使用上一步获得的授权，向认证服务器申请令牌。</li><li>认证服务器对客户端进行认证以后，确认无误，同意发放令牌。</li><li>客户端使用令牌，向资源服务器申请获取资源。</li><li>资源服务器确认令牌无误，同意向客户端开放资源。</li></ol><p>在步骤2中，客户端授权的方式有多种：</p><h4 id="授权码模式" tabindex="-1">授权码模式 <a class="header-anchor" href="#授权码模式" aria-hidden="true">#</a></h4><ol><li>用户访问网易云音乐，网易云音乐要求用户提供qq的授权，指定一个&quot;<strong>重定向<code>URI</code></strong>&quot;，并跳转到<code>qq</code>设置的授权登录页面</li><li>在<code>qq</code>设置的授权登录页面，用户选择授权范围，完成验证后<code>qq</code><strong>认证服务器</strong>返回一个<strong>授权码</strong>，携带<strong>授权码</strong>返回网易云音乐指定的&quot;<strong>重定向<code>URI</code></strong>&quot;</li><li>网易云音乐获得<strong>授权码</strong>，附上指定的&quot;<strong>重定向<code>URI</code></strong>&quot;，向认证服务器申请<strong>令牌</strong></li><li>认证服务器核对了<strong>授权码</strong>和&quot;<strong>重定向<code>URI</code></strong>&quot;，确认无误后，向客户端发送<strong>访问令牌</strong>（<code>access token</code>）和<strong>更新令牌</strong>（<code>refresh toke</code>n）。</li></ol><p>1步骤中，授权登录页面，包含以下参数：</p><ul><li><code>response_type</code>：表示授权类型，必选项，此处的值固定为&quot;code&quot;</li><li><code>client_id</code>：表示客户端的ID，必选项</li><li><code>redirect_uri</code>：表示重定向<code>URI</code>，可选项</li><li><code>scope</code>：表示申请的权限范围，可选项</li><li><code>state</code>：表示客户端的当前状态，可以指定任意值，认证服务器会原封不动地返回这个值，避免<code>csrf</code>。</li></ul></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-fb8d84c6><div class="edit" data-v-fb8d84c6><div class="edit-link" data-v-fb8d84c6 data-v-1ed99556><!----></div></div><div class="updated" data-v-fb8d84c6><!----></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/doc/md/NodeJs/本地调试npm包" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>本地调试npm包</span></a></div><div class="next" data-v-38ede35f><a class="link" href="/doc/md/NodeJs/进程" data-v-38ede35f><span class="text" data-v-38ede35f>进程</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-38ede35f><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"index.md\":\"984c5292\",\"md_css_基本概念.md\":\"5850f079\",\"md_css_常见问题和实现.md\":\"7b011ece\",\"md_ecmascript_es规范.md\":\"d079a1dd\",\"md_ecmascript_new具体过程.md\":\"7ae8121e\",\"md_ecmascript_typescript.md\":\"2ff90780\",\"md_ecmascript_关键概念.md\":\"8bfd9ae7\",\"md_ecmascript_函数.md\":\"dc5f70f1\",\"md_ecmascript_类型.md\":\"6576af71\",\"md_ecmascript_继承.md\":\"0e0eb4bf\",\"md_ecmascript_防篡改对象.md\":\"7553cb72\",\"md_ecmascript_面向对象.md\":\"ef1d6212\",\"md_git_git-flow.md\":\"d4bc0849\",\"md_git_gitlab_gitlab-runner.md\":\"e297858b\",\"md_nodejs_date和时区.md\":\"38f8442e\",\"md_nodejs_npm与package-json.md\":\"01b3107c\",\"md_nodejs_pm2.md\":\"474a0ab0\",\"md_nodejs_require.md\":\"82f68bdf\",\"md_nodejs_全局变量.md\":\"440ecd76\",\"md_nodejs_本地调试npm包.md\":\"ee8244c8\",\"md_nodejs_登录方式.md\":\"a7db5c52\",\"md_nodejs_进程.md\":\"13be3ecd\",\"md_vscode_代码片段.md\":\"e33234bd\",\"md_vue_vue2_相关概念和原理.md\":\"5ba36fae\",\"md_vue_vue2_组件中使用echarts.md\":\"c266d04f\",\"md_vue_vue3_compositionapi.md\":\"da3016ae\",\"md_vue_vue3_与vue2比较的优化.md\":\"a12b7b7f\",\"md_vue_vue3_与vue2比较的新特性.md\":\"9a79716f\",\"md_vue_vue3_副作用.md\":\"84d46adf\",\"md_vue_vue3_响应式对象.md\":\"24fe6d9a\",\"md_vue_vuex.md\":\"d1c9839d\",\"md_vue_组件之间通信的4种方法.md\":\"3d6201ae\",\"md_vue_组件库的创建.md\":\"b12cdaa7\",\"md_cli_功能架构_初始化项目架构.md\":\"da2b41c3\",\"md_cli_功能架构_基础架构.md\":\"2e6931d9\",\"md_cli_功能架构_模块拆分架构.md\":\"15f4543b\",\"md_cli_开发流程.md\":\"5d486360\",\"md_cli_相关技术_cli-spinner.md\":\"44a2e931\",\"md_cli_相关技术_commander.md\":\"a3d8387e\",\"md_cli_相关技术_ejs.md\":\"caff2a6b\",\"md_cli_相关技术_import-local.md\":\"42e2e18f\",\"md_cli_相关技术_inrequirer.md\":\"e7f843c4\",\"md_cli_相关技术_kebab-case.md\":\"5f84ca4b\",\"md_cli_相关技术_npminstall.md\":\"3bcd25ca\",\"md_cli_相关技术_readline.md\":\"f81780f5\",\"md_cli_相关技术_yargs.md\":\"bd18d677\",\"md_cli_脚手架介绍.md\":\"aca0a4c3\",\"md_业务实现_录音.md\":\"b23d68d0\",\"md_业务实现_打印页面中的元素.md\":\"69e41d33\",\"md_业务实现_登录_vue2-element.md\":\"8ba9bfdd\",\"md_业务实现_登录_主要逻辑.md\":\"e8ca26f7\",\"md_业务实现_表格下载.md\":\"b82ead20\",\"md_其他_cron表达式.md\":\"6e4f8b6d\",\"md_其他_glob.md\":\"4cdf60fd\",\"md_其他_地图概念.md\":\"e4f7d32b\",\"md_其他_正则表达式.md\":\"9e14d4d2\",\"md_常考算法_proxy响应式.md\":\"3ed8b795\",\"md_常考算法_vue2响应式.md\":\"0d9445a5\",\"md_常考算法_apply.md\":\"684c5bdd\",\"md_常考算法_发布订阅.md\":\"47dbe7b5\",\"md_常考算法_数组相关.md\":\"7ed1737f\",\"md_常考算法_树的遍历.md\":\"c51c3377\",\"md_常考算法_深复制.md\":\"3e4f6322\",\"md_常考算法_防抖和节流.md\":\"3b116ad0\",\"md_性能_分析工具.md\":\"7d959dd3\",\"md_性能_前端性能优化.md\":\"a3847d6f\",\"md_数据库_mysql.md\":\"8b84cc2b\",\"md_数据库_sequelize.md\":\"2e0c50e0\",\"md_服务器_docker.md\":\"5adfa539\",\"md_服务器_nginx.md\":\"95cb8a24\",\"md_构建_nodemon.md\":\"c36d321a\",\"md_构建_rollup.md\":\"d601ae92\",\"md_构建_vite.md\":\"34f99cc8\",\"md_构建_webpack.md\":\"5ff6e33c\",\"md_构建_代码规范_eslint.md\":\"a0865139\",\"md_构建_代码规范_editor-config.md\":\"f8b4df78\",\"md_构建_代码规范_项目结构规范.md\":\"0ece9f9d\",\"md_构建_包管理-lerna_lerna源码.md\":\"7b1a094d\",\"md_构建_包管理-lerna_lerna简介.md\":\"146663b9\",\"md_构建_包管理-pnpm_简介.md\":\"5a9817bd\",\"md_构建_持续集成部署ci_gitlab-runner.md\":\"58cb4678\",\"md_构建_持续集成部署ci_travis.md\":\"a04fd0bc\",\"md_构建_提交规范_commitizen.md\":\"f017fb54\",\"md_构建_提交规范_commitlint.md\":\"c30f3075\",\"md_构建_提交规范_husky.md\":\"59b85b04\",\"md_构建_提交规范_lint-staged.md\":\"7e235771\",\"md_构建_提交规范_pretty-quick.md\":\"b0aa0487\",\"md_构建_文档构建_vitepress.md\":\"927c96be\",\"md_构建_模块化.md\":\"66b92cdb\",\"md_构建_私有模块仓库_verdaccio.md\":\"405a9c2b\",\"md_浏览器设备_gc（垃圾回收机制）.md\":\"4336bd5e\",\"md_浏览器设备_事件循环.md\":\"efe10082\",\"md_浏览器设备_储存.md\":\"08bf03cd\",\"md_浏览器设备_关键渲染路径.md\":\"0c8c9ba0\",\"md_浏览器设备_兼容.md\":\"7fd5912c\",\"md_浏览器设备_小程序.md\":\"feb0d34b\",\"md_浏览器设备_盒模型.md\":\"20db8312\",\"md_浏览器设备_相关概念.md\":\"e94ce447\",\"md_浏览器设备_跨域.md\":\"4a2515bb\",\"md_网络_graphql和restfulapi.md\":\"a1a805e1\",\"md_网络_https.md\":\"136f33cc\",\"md_网络_http基础.md\":\"cd8d4fcb\",\"md_网络_http版本.md\":\"613a8f6d\",\"md_网络_seo.md\":\"a791a0fd\",\"md_网络_web的攻击技术.md\":\"d675afef\",\"md_网络_网络基础.md\":\"704e6335\"}")</script>
    <script type="module" async src="/doc/assets/app.ca5faf2f.js"></script>
    
  </body>
</html>