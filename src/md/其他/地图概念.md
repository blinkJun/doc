# 地图地理相关概念

## 相关概念
- `GIS`（`Geographic Information System`）：地理信息系统

## 规范的定义
有这么一个联盟，叫`OGC`（`Open Geospatial Consortium`），这个联盟/组织定义了很多关于互联网地图的规则。
然后，开发者，企业，组织机构依照这个规则进行地理信息系统的开发。

## 常用的地图数据源格式
1. 栅格类型：
  - `image`：图片类型

2. `vector`矢量类型：不随放大程度改变而失真
  - `GeoJSON`：数据描述类型
  - `KML`
  - `GML`
  - `shapefile`
  - `svg`

## `tile`切片
如果一张地图包含了庞大的数据，分辨率又高，将会占用非常大的容量，服务器支撑不起来，所有有了一种解决方法：切片。
所谓切片，是指把我们原始的地图切成很多方片，就是拼图里面一格一格的那种图片，我们想看哪就加载哪，不想看就不加载。这样做的话就打打提高了加载效率。加快了浏览速度。并且现在很多地图服务器的切片是有缓存的，能保证下次请求更快捷

## 服务
1. `WMS`（`web map service`）：**网络地图服务**，图片格式的地图被封装成了叫做WMS的服务，只是一张图
2. `WFS`（`web feature service`）：**网络要素服务**，数据为矢量图形，不会失真，可交互和编辑，改变形状
3. `WMTS`（`web map tile service`）：**网络地图切片服务**，将图片切片后的的服务，提高了加载效率


## 各个地图厂家使用的地图坐标系

- 天地图：`CGCS2000`，2000国家大地坐标系；我们其实很多时候直接用WGS84的坐标来代替CGCS2000坐标。因为CGCS2000的定义与`WGS84`实质一样。采用的参考椭球非常接近。扁率差异引起椭球面上的纬度和高度变化最大达0.1mm。当前测量精度范围内，可以忽略这点差异。可以说两者相容至cm级水平，但若一点的坐标精度达不到cm水平，则不认为CGCS2000和WGS84的坐标是相容的。

- 百度地图：`bd09II`坐标。首先了解一下火星坐标，它是在国际标准坐标WGS-84上进行的一次加密，由于国内的电子地图都要至少使用火星坐标进行一次加密，百度直接就任性一些，直接自己又研究了一套加密算法，来了个二次加密，这就是我们所熟知的百度坐标(BD-09)。

- 高德地图、腾讯地图：`gcj02`坐标，也称为火星坐标。火星坐标是国家测绘局为了国家安全在原始坐标的基础上进行偏移得到的坐标，基本国内的电子地图、导航设备都是采用的这一坐标系或在这一坐标的基础上进行二次加密得到的。

- 谷歌（使用GCJ02和WGS84）：国内版经纬度用的 `GCJ02`，国外版用的是`WGS84`，通常【GPS设备获取到的原始经纬度和国外的地图厂商使用的都是WGS-84坐标系】，此外它的EPSG编号为EPSG:4326。

- Leaflet：默认使用EPSG:3857，也可以使用WGS84

GCJ02、BD09、WGS84都是地理坐标系，球面坐标，单位为度，这种坐标方便在地球上定位，但是不方便展示和进行面积距离计算，我们印象中的地图都是平面的，所以就有了另外一种平面坐标系，平面坐标系是通过投影的方式从地理坐标系中转换过来，所以也称为投影坐标系，通常单位为米，投影坐标系根据投影方式的不同存在多种，在Web开发的场景里通常使用的是Web墨卡托投影，编号为EPSG:3857，它基于墨卡托投影，把WGS-84坐标系投影成正方形，这是通过舍弃了南北85.051129纬度以上的地区实现的，因为它是正方形，所以一个大的正方形可以很方便的被分割为更小的正方形。

使用 [`gcoord`](https://www.npmjs.com/package/gcoord) 插件对不同坐标系的坐标进行转换：

安装：
```bash
npm i gcoord --save
```

使用：
```js
import gcoord from 'gcoord';

var result = gcoord.transform(
  [116.403988, 39.914266],    // 经纬度坐标
  gcoord.WGS84,               // 当前坐标系
  gcoord.BD09                 // 目标坐标系
);

console.log(result);  // [122.99395597, 44.99804071]
```
